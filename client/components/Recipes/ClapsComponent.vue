<template>
    <div class="w-56 h-40 flex flex-col justify-center items-center">
      <div class="h-12 w-12 flex justify-center items-end">
        <transition name="click-counter" mode="out-in">
          <div :key="accCounter" class="absolute opacity-0 h-9 w-9 flex items-center justify-center rounded-full bg-rose text-xs text-white font-semibold">
            +{{ accCounter }}
          </div>
        </transition>
      </div>
      <transition name="fadein" mode="out-in">
        <div :key="totalCount" class="text-xs text-gray-600">{{ totalCount }}</div>
      </transition>
      <transition name="bounce-heart" mode="out-in">
        <div @click="updateCounter" class="cursor-pointer z-10" :key="totalCount">
          <svg v-if="accCounter < 50" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="50" height="50"><path fill="#ed7899" d="M32,56.999c0.768,0.006,1.538-0.196,2.22-0.609c4.26-2.56,13.9-8.76,20.84-16.39 C59.61,35.03,63,29.45,63,23.89C63,14.56,55.44,7,46.11,7c-4.619,0-8.811,1.863-11.854,4.875C34.214,11.916,33.125,13,32,13 c-1.125,0-2.214-1.084-2.256-1.125C26.701,8.863,22.509,7,17.89,7C8.56,7,1,14.56,1,23.89C1,29.45,4.39,35.03,8.94,40 c6.94,7.63,16.58,13.83,20.84,16.39C30.462,56.802,31.232,57.005,32,56.999L32,56.999z"/><path fill="#f283a5" d="M56.874,10.77c4.066,4.418,6.087,8.836,6.045,13.254c-0.013,1.371-1.134,2.476-2.505,2.476l0,0 c-1.413,0-2.498-1.171-2.494-2.584c0-0.009,0-0.018,0-0.026c0-6.56-5.34-11.89-11.89-11.89c-0.932,0-1.857,0.113-2.751,0.328 c-1.098,0.264-2.234-0.246-2.77-1.24l-0.004-0.008c-0.78-1.448,0.028-3.239,1.628-3.621c4.397-1.049,9.453-0.386,14.262,2.895 C56.568,10.472,56.732,10.616,56.874,10.77z"/><path fill="#e0678f" d="M31.994,56.716c-1.071,0-2.155-0.287-3.134-0.888c-3.762-2.311-13.236-8.48-19.933-15.842 c-0.612-0.668-1.219-1.377-1.896-2.216c-2.082-2.578-1.68-6.356,0.898-8.438c2.579-2.082,6.356-1.679,8.438,0.898 c0.518,0.641,0.97,1.17,1.424,1.666c5.834,6.415,14.754,12.112,17.35,13.706c2.824,1.734,3.707,5.429,1.973,8.253 C35.98,55.699,34.011,56.716,31.994,56.716z"/><path fill="#8d6c9f" d="M32.032,57.999c-0.021,0-0.043,0-0.064,0c-0.954,0-1.889-0.26-2.705-0.754 c-4.93-2.961-14.224-9.054-21.063-16.572C2.76,34.731,0,29.084,0,23.89C0,14.025,8.025,6,17.89,6c4.733,0,9.193,1.834,12.558,5.164 C30.723,11.439,31.459,12,32,12s1.277-0.561,1.549-0.832C36.917,7.834,41.377,6,46.11,6C55.975,6,64,14.025,64,23.89 c0,5.194-2.76,10.842-8.203,16.786c-6.836,7.516-16.13,13.608-21.063,16.571C33.921,57.739,32.986,57.999,32.032,57.999z M32,55.999 h0.008c0.619-0.005,1.185-0.156,1.694-0.465c3.897-2.342,13.703-8.604,20.617-16.207C59.417,33.761,62,28.567,62,23.89 C62,15.128,54.872,8,46.11,8c-4.203,0-8.163,1.629-11.151,4.586C34.727,12.819,33.471,14,32,14s-2.727-1.181-2.963-1.418 C26.053,9.629,22.093,8,17.89,8C9.128,8,2,15.128,2,23.89c0,4.678,2.583,9.871,7.678,15.435C16.595,46.93,26.4,53.192,30.295,55.532 c0.514,0.311,1.067,0.467,1.697,0.467H32z"/><path fill="#8d6c9f" d="M49.865 11.584C48.619 11.196 47.319 11 46 11c-.552 0-1 .447-1 1s.448 1 1 1c1.117 0 2.218.166 3.271.494.099.03.199.045.297.045.426 0 .821-.274.955-.703C50.687 12.309 50.393 11.748 49.865 11.584zM56.675 21.334c.113.455.521.759.969.759.08 0 .162-.01.243-.029.536-.134.862-.677.729-1.212-.74-2.974-2.523-5.603-5.021-7.404-.448-.32-1.073-.22-1.396.227-.323.448-.222 1.073.226 1.396C54.54 16.595 56.049 18.819 56.675 21.334zM30.967 52.211c-.174 0-.35-.045-.511-.141-.475-.283-.63-.896-.348-1.371l1.023-1.718c.283-.474.896-.63 1.371-.348.475.283.63.896.348 1.371l-1.023 1.718C31.64 52.037 31.308 52.211 30.967 52.211zM26.674 49.559c-.195 0-.392-.057-.565-.176-.456-.313-.571-.935-.258-1.39l1.132-1.649c.313-.455.935-.572 1.39-.258.456.313.571.935.258 1.39L27.5 49.125C27.306 49.407 26.993 49.559 26.674 49.559zM22.564 46.599c-.216 0-.435-.07-.618-.214-.434-.341-.509-.97-.168-1.404l1.236-1.572c.342-.435.971-.51 1.404-.168.434.341.509.97.168 1.404l-1.236 1.572C23.153 46.468 22.86 46.599 22.564 46.599zM18.635 43.407c-.238 0-.476-.084-.667-.255-.411-.369-.446-1.001-.077-1.412l1.335-1.489c.368-.412 1-.446 1.412-.077.411.369.446 1.001.077 1.412l-1.335 1.489C19.182 43.294 18.909 43.407 18.635 43.407zM14.899 39.979c-.259 0-.518-.1-.714-.3-.386-.395-.38-1.028.014-1.415l1.428-1.4c.395-.386 1.027-.38 1.415.014.386.395.38 1.028-.014 1.415l-1.428 1.4C15.404 39.884 15.151 39.979 14.899 39.979zM11.438 36.26c-.281 0-.561-.118-.758-.348-.36-.418-.313-1.05.105-1.41l1.516-1.305c.419-.36 1.05-.313 1.41.105.36.418.313 1.05-.105 1.41l-1.516 1.305C11.9 36.181 11.668 36.26 11.438 36.26z"/></svg>
          <svg v-else xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="50" height="50"><path fill="#ed7899" d="M63,21.615c0-9.33-7.56-16.89-16.89-16.89c-4.619,0-8.811,1.863-11.854,4.875 c-0.042,0.041-1.131,1.125-2.256,1.125S29.786,9.641,29.744,9.6c-3.043-3.012-7.235-4.875-11.854-4.875 C8.56,4.725,1,12.285,1,21.615c0,5.56,3.39,11.14,7.94,16.11c2.763,3.037,5.951,5.842,9.06,8.286v5.332 c0,1.769,1.34,3.197,3,3.197s3-1.428,3-3.197v-0.94c1.93,1.317,3.656,2.415,5,3.238v5.162C29,60.572,30.34,62,32,62 s3-1.428,3-3.197v-5.162c1.344-0.823,3.07-1.921,5-3.238v4.137c0,1.769,1.34,3.197,3,3.197s3-1.428,3-3.197v-8.529 c1.67-1.313,3.362-2.727,5-4.23v2.102c0,1.769,1.34,3.197,3,3.197s3-1.428,3-3.197v-8.413C60.538,31.095,63,26.349,63,21.615z"/><path fill="#e0678f" d="M16.51,30.63c-4.74-5.28-5.25-8.34-5.25-9.41c0-1.109,0.258-2.157,0.714-3.081 c0.906-1.836,0.424-4.057-1.073-5.453l0,0c-2.337-2.179-6.129-1.481-7.517,1.397C2.344,16.238,1.76,18.661,1.76,21.22 c0,4.78,2.59,10.08,7.68,15.76c0.872,0.977,1.789,1.933,2.734,2.862c1.952,1.917,5.132,1.75,6.912-0.328l0.002-0.002 c1.633-1.908,1.48-4.739-0.309-6.502C17.991,32.233,17.23,31.438,16.51,30.63z"/><path fill="#f283a5" d="M62.92,21.75c-0.01,0.86-0.45,1.61-1.11,2.05c-0.4,0.26-0.88,0.42-1.4,0.42 c-0.71,0-1.33-0.29-1.77-0.76c-0.45-0.47-0.72-1.12-0.72-1.82v-0.03c0-0.61-0.05-1.22-0.14-1.81 c-0.54-3.54-2.65-6.58-5.6-8.37c-0.53-0.32-1.09-0.6-1.67-0.84c-1.38-0.56-2.9-0.87-4.48-0.87c-0.34,0-0.68,0.02-1.02,0.05 c-0.59,0.05-1.17,0.15-1.73,0.28c-1.1,0.27-2.24-0.24-2.77-1.24L40.5,8.8c-0.35-0.65-0.38-1.37-0.15-2 c0.26-0.77,0.9-1.4,1.78-1.62c4.4-1.05,9.46-0.38,14.26,2.9c0.18,0.12,0.34,0.26,0.48,0.41 C60.94,12.91,62.96,17.33,62.92,21.75z"/><path fill="#8d6c9f" d="M46.11,3.72c-4.73,0-9.19,1.84-12.56,5.17C33.28,9.16,32.54,9.72,32,9.72s-1.28-0.56-1.55-0.83 c-3.37-3.33-7.83-5.17-12.56-5.17C8.02,3.72,0,11.75,0,21.61c0,5.2,2.76,10.85,8.2,16.79c2.69,2.96,5.76,5.7,8.8,8.11V52 c0,2.21,1.79,4,4,4c2.12,0,3.85-1.64,3.99-3.72c1.09,0.72,2.1,1.36,3.01,1.92V59c0,2.21,1.79,4,4,4s4-1.79,4-4v-4.8 c0.91-0.56,1.92-1.2,3-1.92V55c0,2.21,1.79,4,4,4s4-1.79,4-4v-8.49c1-0.79,2.01-1.62,3-2.49V45c0,2.21,1.79,4,4,4s4-1.79,4-4 v-9.18c3.99-5,6-9.77,6-14.21C64,11.75,55.97,3.72,46.11,3.72z M58,32.47c-0.264,0.392-1.269,1.728-1.783,2.374 C56.075,35.022,56,35.239,56,35.466l0,9.412c0,0.997-0.675,1.928-1.658,2.093C53.093,47.181,52,46.212,52,45v-3.229 c0-0.873-1.043-1.324-1.683-0.73C50.181,41.167,50.07,41.268,50,41.33c-0.99,0.9-1.99,1.76-3,2.59 c-0.252,0.206-1.092,0.878-1.623,1.296C45.137,45.406,45,45.692,45,45.999l0,8.88c0,0.997-0.675,1.928-1.658,2.093 C42.093,57.181,41,56.212,41,55v-4.6c0-0.808-0.911-1.28-1.575-0.819c-0.188,0.13-0.342,0.238-0.425,0.298 c-1.09,0.73-2.11,1.39-3,1.97c-0.255,0.156-1.004,0.619-1.525,0.939C34.179,52.971,34,53.293,34,53.641l0,5.238 c0,0.997-0.675,1.928-1.658,2.093C31.093,61.181,30,60.212,30,59v-5.359c0-0.348-0.179-0.669-0.475-0.851 c-0.521-0.32-1.269-0.783-1.525-0.939c-0.89-0.58-1.91-1.24-3-1.97c-0.084-0.06-0.238-0.168-0.425-0.298 C23.911,49.121,23,49.593,23,50.4l0,1.478c0,0.997-0.675,1.928-1.658,2.093C20.093,54.181,19,53.212,19,52v-6.001 c0-0.306-0.137-0.593-0.377-0.782c-0.53-0.418-1.371-1.09-1.623-1.296c-2.54-2.09-5.08-4.41-7.32-6.87 C4.58,31.49,2,26.29,2,21.61C2,12.85,9.13,5.72,17.89,5.72c4.2,0,8.16,1.63,11.15,4.59c0.23,0.23,1.49,1.41,2.96,1.41 s2.73-1.18,2.96-1.41c1.57-1.55,3.4-2.73,5.39-3.51c2.131-0.836,4.457-1.201,6.83-1.045c7.618,0.5,13.764,6.598,14.714,14.173 c0.158,1.258,0.149,2.549-0.083,3.872C61.37,26.54,60.1,29.44,58,32.47z"/><path fill="#8d6c9f" d="M58.62,18.58c-0.74-2.98-2.53-5.61-5.02-7.41c-0.45-0.32-1.08-0.22-1.4,0.23 c-0.01,0.01-0.01,0.02-0.02,0.03c-0.3,0.45-0.19,1.05,0.25,1.37c2.11,1.52,3.62,3.74,4.24,6.26c0.12,0.45,0.53,0.76,0.97,0.76 c0.04,0,0.09,0,0.14-0.02c0.04,0.01,0.07,0,0.11-0.01C58.42,19.65,58.75,19.11,58.62,18.58z M49.87,9.31 C48.62,8.92,47.32,8.72,46,8.72c-0.55,0-1,0.45-1,1c0,0.02,0,0.03,0.01,0.05c0.02,0.54,0.46,0.95,0.99,0.95 c1.12,0,2.22,0.17,3.27,0.5c0.1,0.03,0.2,0.04,0.3,0.04c0.41,0,0.8-0.26,0.94-0.67c0-0.01,0.01-0.02,0.01-0.03 C50.69,10.03,50.39,9.47,49.87,9.31z"/><path fill="#8d6c9f" d="M14.397,37.16c-0.26,0-0.519-0.101-0.715-0.301c-0.386-0.395-0.379-1.028,0.016-1.414 l1.43-1.398c0.394-0.387,1.027-0.38,1.414,0.016c0.386,0.395,0.379,1.028-0.016,1.414l-1.43,1.398 C14.902,37.065,14.65,37.16,14.397,37.16z"/><path fill="#8d6c9f" d="M10.92,33.249c-0.295,0-0.587-0.13-0.784-0.379c-0.343-0.433-0.27-1.062,0.163-1.405 l1.567-1.242c0.432-0.344,1.061-0.27,1.405,0.163c0.343,0.433,0.27,1.062-0.163,1.405l-1.567,1.242 C11.357,33.179,11.138,33.249,10.92,33.249z"/><path fill="#8d6c9f" d="M7.967,28.85c-0.355,0-0.699-0.189-0.88-0.523C6.823,27.84,7.004,27.233,7.49,26.97 l1.759-0.952c0.485-0.262,1.092-0.082,1.355,0.404c0.263,0.485,0.083,1.092-0.403,1.355l-1.759,0.952 C8.291,28.811,8.127,28.85,7.967,28.85z"/><path fill="#8d6c9f" d="M6.116,23.722c-0.486,0-0.912-0.354-0.987-0.85c-0.083-0.547,0.293-1.057,0.839-1.139 l1.977-0.3C8.486,21.35,9,21.726,9.083,22.271c0.083,0.547-0.293,1.057-0.839,1.139l-1.977,0.3 C6.217,23.718,6.167,23.722,6.116,23.722z"/><path fill="#8d6c9f" d="M8.57,18.837c-0.107,0-0.216-0.017-0.323-0.054l-1.893-0.646 c-0.523-0.178-0.802-0.746-0.624-1.27C5.909,16.347,6.478,16.062,7,16.245l1.893,0.646c0.523,0.178,0.802,0.746,0.624,1.27 C9.375,18.575,8.986,18.837,8.57,18.837z"/><g><circle cx="54" cy="55" r="3" fill="#f283a5"/><path fill="#8d6c9f" d="M54,51c-2.21,0-4,1.79-4,4c0,2.21,1.79,4,4,4s4-1.79,4-4C58,52.79,56.21,51,54,51z M54,57 c-1.1,0-2-0.9-2-2c0-1.1,0.9-2,2-2s2,0.9,2,2C56,56.1,55.1,57,54,57z"/></g></svg>
        </div>
      </transition>
      <div v-for="n in 3" :key="n" class="particles-container mt-8 z-0" :style="randomRotationAngle(1, 72)">
        <div class="triangle" :class="particlesAnimationPopTop">
          <div class="square"></div>
        </div>
        <div class="triangle" :class="particlesAnimationPopTopLeft">
          <div class="square"></div>
        </div>
        <div class="triangle" :class="particlesAnimationPopTopRight">
          <div class="square"></div>
        </div>
        <div class="triangle" :class="particlesAnimationPopBottomRight">
          <div class="square"></div>
        </div>
        <div class="triangle" :class="particlesAnimationPopBottomLeft">
          <div class="square"></div>
        </div>
      </div>
    </div>
</template>

<script>
export default {
  name: "ClapsComponent",
  data: () => ({
    isAnimated: false,
    accCounter: 0,
    totalCount: 127, // Todo
  }),
  methods : {
    updateCounter() {
      if (this.accCounter > 49) { return }
      this.isAnimated = true
      this.accCounter++
      this.totalCount++
      setTimeout(()=> {
        this.isAnimated = false
      }, 1000)
    },
    randomRotationAngle (min, max) {
      const randomInt = Math.floor(Math.random() * (max - min  + 1)) + min
      return `transform: rotate(${randomInt}deg)`
    }
  },
  computed: {
    particlesAnimationPopTop () {
      if (!this.isAnimated) {
        return ''
      }
      return 'particles-pop-top'
    },
    particlesAnimationPopTopLeft () {
      if (!this.isAnimated) {
        return ''
      }
      return 'particles-pop-top-left'
    },
    particlesAnimationPopTopRight () {
      if (!this.isAnimated) {
        return ''
      }
      return 'particles-pop-top-right'
    },
    particlesAnimationPopBottomRight () {
      if (!this.isAnimated) {
        return ''
      }
      return 'particles-pop-bottom-right'
    },
    particlesAnimationPopBottomLeft () {
      if (!this.isAnimated) {
        return ''
      }
      return 'particles-pop-bottom-left'
    },
  }
}
</script>

<style scoped>
  .bg-rose {
    background: #EC779A;
  }
  /*
    TOTAL COUNTER
  */
  .fadein-enter-active {
    animation: fade-in 1400ms;
  }
  @keyframes fade-in {
    0% {
      opacity: 0;
    }
    50% {
      opacity: 0;
    }
    100% {
      opacity: 1;
    }
  }

  /*
    HEART
  */
  .bounce-heart-enter-active {
    animation: bounce 700ms;
  }
  @keyframes bounce{
    0% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.15);
    }
    100% {
      transform: scale(1);
    }
  }

  /*
    CLICK COUNTER
  */

  .click-counter-enter-active {
    animation: bump-out 800ms;
  }

  @keyframes bump-out {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    25% {
      transform: scale(1.10);
      opacity: 1;
    }
    50% {
      transform: scale(1);
      opacity: 1;
    }
    100% {
      transform: translateY(-25px) scale(1);
      opacity: 0;
    }
  }

  /*
    PARTICLES
  */

  .particles-pop-top {
    animation: pop-top 1s forwards;
  }
  .particles-pop-top-left {
    animation: pop-top-left 1s;
  }
  .particles-pop-top-right {
    animation: pop-top-right 1s;
  }
  .particles-pop-bottom-right {
    animation: pop-bottom-right 1s;
  }
  .particles-pop-bottom-left {
    animation: pop-bottom-left 1s;
  }

  @keyframes pop-top {
    0% {
      transform: translate(0, 0) rotate(0);
      opacity: 0.4;
    }
    100% {
      transform: translate(0, -100px) rotate(0);
      opacity: 0;
    }
  }
  @keyframes pop-top-left {
    0% {
      transform: translate(0, 0) rotate(-55deg);
      opacity: 0.4;
    }
    100% {
      transform: translate(-100px, -50px) rotate(-55deg);
      opacity: 0;
    }
  }
  @keyframes pop-top-right {
    0% {
      transform: translate(0, 0) rotate(70deg);
      opacity: 0.4;
    }
    100% {
      transform: translate(100px, -50px) rotate(70deg);
      opacity: 0;
    }
  }
  @keyframes pop-bottom-right {
    0% {
      transform: translate(0, 0) rotate(135deg);
      opacity: 0.4;
    }
    100% {
      transform: translate(70px, 80px) rotate(135deg);
      opacity: 0;
    }
  }
  @keyframes pop-bottom-left {
    0% {
      transform: translate(0, 0) rotate(-135deg);
      opacity: 0.4;
    }
    100% {
      transform: translate(-70px, 80px) rotate(-135deg);
      opacity: 0;
    }
  }


  .particles-container {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 60px;
    height: 60px;
    position: absolute;
  }
  .particles-container .triangle {
    border-left: 4px solid transparent;
    border-right: 4px solid transparent;
    border-top: 10px solid #EC779A;
    border-bottom: 4px solid transparent;
    position: absolute;
  }
  .particles-container .triangle .square {
    width: 5px;
    height: 5px;
    background: #BCABC6;
    position: absolute;
    left: -15px;
    top: 0;
  }

</style>
